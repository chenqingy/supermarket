<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"/> 
        <title>小票打印</title>
        <script src="lib/jquery-3.2.1.js"></script>
        <style type="text/css">
        *{padding:0;margin: 0;}
        h1{font-size: 20px;}
        h3{font-size: 16px;}
        .left{float: left;}
        .right{float:right;}
        .clearfix{clear: both;}
        ul{list-style: none;}
        .print_container{padding: 20px;width: 220px;margin: 0 auto;}
      
        .section2 label{ display: block; }
        .section3 label{display: block;}
      
        .section4 .total label{display: block;}
        .section4 .other_fee{border-bottom: 1px solid #DADADA;}
        .section5 label{display: block;}
        .times{float:right;}
        </style>
        <link rel="stylesheet" type="text/css" href="lib/bootstrap/dist/css/bootstrap.min.css" />
    </head>
    <body style="background-color:#fff;">
        <div class="print_container">
            <h1>给顾客专用</h1>
            <span>************************************</span>
            <div class="section1">
                <h3>超市打印小票</h3>
                <h3>在线支付预约</h3>
            </div>
            
            <span>************************************</span>
            <div class="section3">
                <label>下单时间：<span class="times">222</span></label>
            </div>
            <span>************************************</span>
            <div class="section4">
                <div style="border-bottom: 1px solid #DADADA;">
                    <!--<ul>
                        <div>菜单名称     数量    金额</div>
                        <li>米饭米饭 米饭 米饭 米饭 米饭 米饭       2    28元</li>
                        <li>米饭      2    28元</li>
                    </ul>-->
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <td width="60%">商品名称</td>
                                <td width="20%">数量</td>
                                <td width="20%">单价</td>
                            </tr>
                        </thead>
                        <tbody class="dealWith">
                            
                        </tbody>
                    </table>
                </div>
                <div class="other_fee">
                    <div class="peis">
                        <label class="left">配送费</label>
                        <label class="right">0</label>
                        <div class="clearfix"></div>
                    </div>
                    <div class="manj">
                        <label class="left">立减优惠</label>
                        <label class="right">0</label>
                        <div class="clearfix"></div>
                    </div>
                </div>
                <div class="total">
                    <label class="left">总计</label>
                    <label class="right tatol"></label>
                    <div class="clearfix"></div>
                </div>
                <div style="text-align: right;">
                    <label>顾客已付款</label>
                </div>
                <span>************************************</span>
            </div>
            <div class="section5">
                <label>姓名：小鱼鱼</label>
                <label>地址：千峰</label>
                <label>电话：12800</label>
            </div>    
            <span>************************************</span>
            <div class="btn">
                <button type="button" class="btn btn-success">确定购买</button>
                <button type="button" class="btn btn-danger">取消购买</button>
            </div>
        </div>
        
        
        <script type="text/javascript">
            window.onload = function(){
                var cookies = document.cookie;

                var carlist = [];
                if(cookies.length>0){
                    cookies = cookies.split('; ');
                    cookies.forEach(function(cookie){
                        var temp = cookie.split('=');

                        if(temp[0] === 'carlist'){
                            // 把json字符串转成数组
                            carlist = JSON.parse(temp[1]);
                        }
                    });
                }
                console.log(carlist);
                //获取传递过来的参数
                var tatol = 0;
                var date = new Date();

                // console.log();
                $('.times').html(date.toLocaleString( ))
                $('.dealWith').html(carlist.map(function(item){
                    // console.log(item.sale_price*item.goods_qty)
                    tatol += item.price*item.qty;
                    return `<tr>
                        <td>${item.name}</td>
                        <td>${item.qty}</td>
                        <td>${item.price}</td>
                    </tr>`
                }));
                // console.log(tatol)
                $('.tatol').text(tatol)
                
                $('.btn-danger').click(function() {
                    var day = date.toLocaleString() - 10;
                    document.cookie = 'carlist=' + null + ';expires=' + day;
                    window.location.href="http://10.3.131.14:222/orderControl.html";
                });
            }
        </script>
    </body>
</html>